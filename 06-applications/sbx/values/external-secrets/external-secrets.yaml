# External Secrets Operator Helm values for AWS EKS
installCRDs: true

# Include ClusterSecretStore, SecretStore, and ServiceAccount as extra objects
extraObjects:
  # ServiceAccount for IRSA
  - apiVersion: v1
    kind: ServiceAccount
    metadata:
      name: cluster-secrets
      namespace: external-secrets
      annotations:
        eks.amazonaws.com/role-arn: "arn:aws:iam::696630818863:role/acme-dogfood-sbx-euc2-cluster-secrets"
  
  # ClusterSecretStore for AWS Secrets Manager
  - apiVersion: external-secrets.io/v1beta1
    kind: ClusterSecretStore
    metadata:
      name: aws-secrets-manager
    spec:
      provider:
        aws:
          service: SecretsManager
          region: eu-central-2
          auth:
            jwt:
              serviceAccountRef:
                name: cluster-secrets
                namespace: external-secrets
  
  # SecretStore that references the ClusterSecretStore
  - apiVersion: external-secrets.io/v1beta1
    kind: SecretStore
    metadata:
      name: aws-secrets-manager
      namespace: external-secrets
      annotations:
        external-secrets.io/managed: "true"
    spec:
      store:
        kind: ClusterSecretStore
        name: aws-secrets-manager
