# ClusterIssuer for Route 53 DNS-01 validation
# Uses Route 53 Private Hosted Zone for DNS-01 challenge validation
# This enables cert-manager to automatically obtain Let's Encrypt certificates
# for domains managed in Route 53 Private Hosted Zone
resources:
  - apiVersion: cert-manager.io/v1
    kind: ClusterIssuer
    metadata:
      name: letsencrypt-route53-dns
    spec:
      acme:
        privateKeySecretRef:
          name: letsencrypt-account-key-route53
        server: https://acme-v02.api.letsencrypt.org/directory
        solvers:
          - dns01:
              route53:
                # IAM role ARN for cert-manager to access Route 53
                # This role must have route53:ChangeResourceRecordSets permission
                # for the hosted zone
                # The role should be annotated on the cert-manager service account
                # When using IRSA, cert-manager automatically uses the IAM role
                # annotated on the service account (no need for accessKeyIDSecretRef)
                region: <AWS_REGION>
                hostedZoneID: <AWS_HOSTED_ZONE_ID>
            selector:
              dnsZones:
                - <DNS_ZONE>

